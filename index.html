<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lyrics Mixer - Combine Songs Creatively</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .lyric-section {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .lyric-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .selected-section {
            background-color: #3b82f6;
            color: white;
        }
        
        .combined-lyric {
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .tab-active {
            border-bottom: 3px solid #3b82f6;
            color: #3b82f6;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-music text-3xl"></i>
                    <h1 class="text-2xl font-bold">Lyrics Mixer</h1>
                </div>
                <button onclick="showAddSongModal()" class="bg-white text-purple-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition">
                    <i class="fas fa-plus mr-2"></i>Add New Song
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Songs Library -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fas fa-book-open mr-2 text-purple-600"></i>
                        Songs Library
                    </h2>
                    <div id="songsList" class="space-y-3">
                        <!-- Songs will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Lyrics Sections -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fas fa-layer-group mr-2 text-purple-600"></i>
                        Lyrics Sections
                    </h2>
                    <div id="sectionsList" class="space-y-3">
                        <p class="text-gray-500 text-center py-8">Select a song to view its sections</p>
                    </div>
                </div>
            </div>

            <!-- Combined Lyrics -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-magic mr-2 text-purple-600"></i>
                            Combined Lyrics
                        </h2>
                        <button onclick="clearCombined()" class="text-red-500 hover:text-red-700 transition">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div id="combinedLyrics" class="space-y-3 min-h-[400px]">
                        <p class="text-gray-500 text-center py-8">Click on sections to add them here</p>
                    </div>
                    <div class="mt-4 flex gap-2">
                        <button onclick="copyToClipboard()" class="flex-1 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                            <i class="fas fa-copy mr-2"></i>Copy
                        </button>
                        <button onclick="saveCombination()" class="flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                            <i class="fas fa-save mr-2"></i>Save
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Saved Combinations -->
        <div class="mt-8 bg-white rounded-xl shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-star mr-2 text-purple-600"></i>
                Saved Combinations
            </h2>
            <div id="savedCombinations" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Saved combinations will appear here -->
            </div>
        </div>
    </main>

    <!-- Add Song Modal -->
    <div id="addSongModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">Add New Song</h3>
                <button onclick="closeAddSongModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="addSongForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Song Title</label>
                    <input type="text" id="songTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Artist</label>
                    <input type="text" id="songArtist" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                </div>
                <div id="sectionsContainer">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Lyrics Sections</label>
                    <div class="space-y-3">
                        <div class="section-input flex gap-2">
                            <select class="section-type px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                                <option value="verse">Verse</option>
                                <option value="chorus">Chorus</option>
                                <option value="bridge">Bridge</option>
                                <option value="pre-chorus">Pre-Chorus</option>
                                <option value="outro">Outro</option>
                            </select>
                            <textarea class="section-lyrics flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" rows="3" placeholder="Enter lyrics..."></textarea>
                            <button type="button" onclick="removeSection(this)" class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <button type="button" onclick="addSectionInput()" class="mt-3 text-purple-600 hover:text-purple-700 font-medium">
                        <i class="fas fa-plus mr-1"></i>Add Section
                    </button>
                </div>
                <div class="flex gap-2 pt-4">
                    <button type="submit" class="flex-1 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                        Add Song
                    </button>
                    <button type="button" onclick="closeAddSongModal()" class="flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-full transition-transform duration-300">
        <i class="fas fa-check-circle mr-2"></i>
        <span id="toastMessage">Success!</span>
    </div>

    <script>
        // Initialize data
        let songs = JSON.parse(localStorage.getItem('lyricsSongs')) || [
            {
                id: 1,
                title: "Bohemian Rhapsody",
                artist: "Queen",
                sections: {
                    "verse": ["Is this the real life?", "Is this just fantasy?", "Caught in a landslide", "No escape from reality"],
                    "chorus": ["Mama, just killed a man", "Put a gun against his head", "Pulled my trigger, now he's dead"],
                    "bridge": ["I see a little silhouetto of a man", "Scaramouche, Scaramouche, will you do the Fandango?"]
                }
            },
            {
                id: 2,
                title: "Shape of You",
                artist: "Ed Sheeran",
                sections: {
                    "verse": ["The club isn't the best place to find a lover", "So the bar is where I go", "Me and my friends at the table doing shots"],
                    "chorus": ["I'm in love with the shape of you", "We push and pull like a magnet do"],
                    "bridge": ["So come on, be my baby", "Come on, come on, be my baby"]
                }
            }
        ];

        let combinedLyrics = [];
        let savedCombinations = JSON.parse(localStorage.getItem('savedCombinations')) || [];
        let selectedSongId = null;

        // Initialize the app
        function init() {
            renderSongs();
            renderSavedCombinations();
        }

        // Render songs list
        function renderSongs() {
            const songsList = document.getElementById('songsList');
            songsList.innerHTML = songs.map(song => `
                <div class="p-4 border border-gray-200 rounded-lg hover:border-purple-400 cursor-pointer transition ${selectedSongId === song.id ? 'border-purple-500 bg-purple-50' : ''}" onclick="selectSong(${song.id})">
                    <h3 class="font-semibold text-gray-800">${song.title}</h3>
                    <p class="text-sm text-gray-600">${song.artist}</p>
                    <div class="mt-2 flex gap-2">
                        ${Object.keys(song.sections).map(type => `
                            <span class="text-xs bg-gray-100 px-2 py-1 rounded">${type}</span>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        // Select a song and show its sections
        function selectSong(songId) {
            selectedSongId = songId;
            renderSongs();
            
            const song = songs.find(s => s.id === songId);
            const sectionsList = document.getElementById('sectionsList');
            
            sectionsList.innerHTML = Object.entries(song.sections).map(([type, lyrics]) => `
                <div class="lyric-section p-4 border border-gray-200 rounded-lg" onclick="addToCombined(${songId}, '${type}')">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium capitalize">${type}</h4>
                        <span class="text-xs text-gray-500">${song.title}</span>
                    </div>
                    <p class="text-sm text-gray-600">${lyrics.join('<br>')}</p>
                </div>
            `).join('');
        }

        // Add section to combined lyrics
        function addToCombined(songId, sectionType) {
            const song = songs.find(s => s.id === songId);
            const lyrics = song.sections[sectionType];
            
            combinedLyrics.push({
                songId,
                songTitle: song.title,
                artist: song.artist,
                type: sectionType,
                lyrics: lyrics
            });
            
            renderCombinedLyrics();
            showToast('Section added!');
        }

        // Render combined lyrics
        function renderCombinedLyrics() {
            const combinedDiv = document.getElementById('combinedLyrics');
            
            if (combinedLyrics.length === 0) {
                combinedDiv.innerHTML = '<p class="text-gray-500 text-center py-8">Click on sections to add them here</p>';
                return;
            }
            
            combinedDiv.innerHTML = combinedLyrics.map((item, index) => `
                <div class="combined-lyric p-4 bg-purple-50 border border-purple-200 rounded-lg relative group">
                    <button onclick="removeFromCombined(${index})" class="absolute top-2 right-2 text-red-500 opacity-0 group-hover:opacity-100 transition">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium capitalize">${item.type}</h4>
                        <span class="text-xs text-gray-600">${item.songTitle} - ${item.artist}</span>
                    </div>
                    <p class="text-sm text-gray-700">${item.lyrics.join('<br>')}</p>
                </div>
            `).join('');
        }

        // Remove from combined lyrics
        function removeFromCombined(index) {
            combinedLyrics.splice(index, 1);
            renderCombinedLyrics();
        }

        // Clear all combined lyrics
        function clearCombined() {
            combinedLyrics = [];
            renderCombinedLyrics();
            showToast('Cleared!');
        }

        // Copy to clipboard
        function copyToClipboard() {
            if (combinedLyrics.length === 0) {
                showToast('Nothing to copy!', 'error');
                return;
            }
            
            const text = combinedLyrics.map(item => 
                `[${item.type.toUpperCase()} - ${item.songTitle}]\n${item.lyrics.join('\n')}`
            ).join('\n\n');
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!');
            });
        }

        // Save combination
        function saveCombination() {
            if (combinedLyrics.length === 0) {
                showToast('Nothing to save!', 'error');
                return;
            }
            
            const name = prompt('Enter a name for this combination:');
            if (!name) return;
            
            const combination = {
                id: Date.now(),
                name,
                lyrics: [...combinedLyrics],
                createdAt: new Date().toISOString()
            };
            
            savedCombinations.unshift(combination);
            localStorage.setItem('savedCombinations', JSON.stringify(savedCombinations));
            renderSavedCombinations();
            showToast('Saved!');
        }

        // Render saved combinations - FIXED VERSION
        function renderSavedCombinations() {
            const savedDiv = document.getElementById('savedCombinations');
            
            // Clear existing content
            savedDiv.innerHTML = '';
            
            if (savedCombinations.length === 0) {
                savedDiv.innerHTML = '<p class="text-gray-500 text-center col-span-full py-8">No saved combinations yet</p>';
                return;
            }
            
            // Create a document fragment to improve performance
            const fragment = document.createDocumentFragment();
            
            savedCombinations.forEach(combination => {
                const combDiv = document.createElement('div');
                combDiv.className = 'border border-gray-200 rounded-lg p-4 hover:shadow-md transition';
                
                combDiv.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-gray-800">${combination.name}</h3>
                        <button onclick="deleteCombination(${combination.id})" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-trash text-sm"></i>
                        </button>
                    </div>
                    <p class="text-xs text-gray-500 mb-2">
                        ${new Date(combination.createdAt).toLocaleDateString()} â€¢ ${combination.lyrics.length} sections
                    </p>
                    <button onclick="loadCombination(${combination.id})" class="text-purple-600 hover:text-purple-700 text-sm font-medium">
                        <i class="fas fa-folder-open mr-1"></i>Load
                    </button>
                `;
                
                fragment.appendChild(combDiv);
            });
            
            // Append all elements at once
            savedDiv.appendChild(fragment);
        }

        // Load combination
        function loadCombination(id) {
            const combination = savedCombinations.find(c => c.id === id);
            if (combination) {
                combinedLyrics = [...combination.lyrics];
                renderCombinedLyrics();
                showToast('Loaded!');
            }
        }

        // Delete combination
        function deleteCombination(id) {
            if (confirm('Are you sure you want to delete this combination?')) {
                savedCombinations = savedCombinations.filter(c => c.id !== id);
                localStorage.setItem('savedCombinations', JSON.stringify(savedCombinations));
                renderSavedCombinations();
                showToast('Deleted!');
            }
        }

        // Show add song modal
        function showAddSongModal() {
            document.getElementById('addSongModal').classList.remove('hidden');
        }

        // Close add song modal
        function closeAddSongModal() {
            document.getElementById('addSongModal').classList.add('hidden');
            document.getElementById('addSongForm').reset();
            // Reset sections container
            const container = document.getElementById('sectionsContainer').querySelector('.space-y-3');
            container.innerHTML = `
                <div class="section-input flex gap-2">
                    <select class="section-type px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                        <option value="verse">Verse</option>
                        <option value="chorus">Chorus</option>
                        <option value="bridge">Bridge</option>
                        <option value="pre-chorus">Pre-Chorus</option>
                        <option value="outro">Outro</option>
                    </select>
                    <textarea class="section-lyrics flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" rows="3" placeholder="Enter lyrics..."></textarea>
                    <button type="button" onclick="removeSection(this)" class="text-red-500 hover:text-red-700">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
        }

        // Add section input
        function addSectionInput() {
            const container = document.getElementById('sectionsContainer').querySelector('.space-y-3');
            const newSection = document.createElement('div');
            newSection.className = 'section-input flex gap-2';
            newSection.innerHTML = `
                <select class="section-type px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                    <option value="verse">Verse</option>
                    <option value="chorus">Chorus</option>
                    <option value="bridge">Bridge</option>
                    <option value="pre-chorus">Pre-Chorus</option>
                    <option value="outro">Outro</option>
                </select>
                <textarea class="section-lyrics flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" rows="3" placeholder="Enter lyrics..."></textarea>
                <button type="button" onclick="removeSection(this)" class="text-red-500 hover:text-red-700">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            container.appendChild(newSection);
        }

        // Remove section input
        function removeSection(button) {
            const container = document.getElementById('sectionsContainer').querySelector('.space-y-3');
            if (container.children.length > 1) {
                button.parentElement.remove();
            }
        }

        // Handle add song form submission
        document.getElementById('addSongForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('songTitle').value;
            const artist = document.getElementById('songArtist').value;
            const sectionInputs = document.querySelectorAll('.section-input');
            
            const sections = {};
            sectionInputs.forEach(input => {
                const type = input.querySelector('.section-type').value;
                const lyrics = input.querySelector('.section-lyrics').value;
                if (lyrics.trim()) {
                    sections[type] = lyrics.split('\n').filter(line => line.trim());
                }
            });
            
            if (Object.keys(sections).length === 0) {
                showToast('Please add at least one section!', 'error');
                return;
            }
            
            const newSong = {
                id: Date.now(),
                title,
                artist,
                sections
            };
            
            songs.push(newSong);
            localStorage.setItem('lyricsSongs', JSON.stringify(songs));
            renderSongs();
            closeAddSongModal();
            showToast('Song added successfully!');
        });

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg transform transition-transform duration-300 ${
                type === 'error' ? 'bg-red-600' : 'bg-green-600'
            } text-white`;
            
            setTimeout(() => {
                toast.classList.remove('translate-y-full');
            }, 100);
            
            setTimeout(() => {
                toast.classList.add('translate-y-full');
            }, 3000);
        }

        // Initialize the app when page loads
        init();
    </script>
</body>
</html>
